{"version":3,"sources":["Slideout.js"],"names":["define","decouple","Emitter","scrollTimeout","child","uber","scrolling","doc","window","document","html","documentElement","msPointerSupported","navigator","msPointerEnabled","touch","start","move","end","prefix","regex","styleDeclaration","getElementsByTagName","style","prop","test","match","toLowerCase","Slideout","options","this","_startOffsetX","_currentOffsetX","_opening","_moved","_opened","_preventOpen","_touch","undefined","_side","side","panel","menu","classList","contains","add","_fx","fx","_duration","parseInt","duration","_tolerance","tolerance","_padding","_translateTo","padding","_orientation","_initTouchEvents","prototype","destination","from","extend","open","self","emit","_setTransition","_translateXTo","setTimeout","transition","close","isOpen","remove","transform","toggle","translateX","_onScrollFn","clearTimeout","_preventMove","eve","preventDefault","addEventListener","_resetTouchFn","touches","pageX","clientWidth","_onTouchCancelFn","_onTouchEndFn","Math","abs","_onTouchMoveFn","el","parentNode","getAttribute","hasIgnoredElements","target","dif_x","clientX","oriented_dif_x","enableTouch","disableTouch","destroy","removeEventListener"],"mappings":"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","file":"../Slideout.js","sourcesContent":["define([\r\n  \"./decouple\",\r\n  \"Emitter\"\r\n],function(decouple,Emitter){\r\n  /**\r\n   * Privates\r\n   */\r\n  var scrollTimeout;\r\n  var scrolling = false;\r\n  var doc = window.document;\r\n  var html = doc.documentElement;\r\n  var msPointerSupported = window.navigator.msPointerEnabled;\r\n  \r\n  var touch = {\r\n    'start': msPointerSupported ? 'MSPointerDown' : 'touchstart',\r\n    'move': msPointerSupported ? 'MSPointerMove' : 'touchmove',\r\n    'end': msPointerSupported ? 'MSPointerUp' : 'touchend'\r\n  };\r\n\r\n  var prefix = (function prefix() {\r\n    var regex = /^(Webkit|Khtml|Moz|ms|O)(?=[A-Z])/;\r\n    var styleDeclaration = doc.getElementsByTagName('script')[0].style;\r\n    for (var prop in styleDeclaration) {\r\n      if (regex.test(prop)) {\r\n        return '-' + prop.match(regex)[0].toLowerCase() + '-';\r\n      }\r\n    }\r\n    // Nothing found so far? Webkit does not enumerate over the CSS properties of the style object.\r\n    // However (prop in style) returns the correct value, so we'll have to test for\r\n    // the precence of a specific property\r\n    if ('WebkitOpacity' in styleDeclaration) { return '-webkit-'; }\r\n    if ('KhtmlOpacity' in styleDeclaration) { return '-khtml-'; }\r\n    return '';\r\n  }());\r\n\r\n  function extend(destination, from) {\r\n    for (var prop in from) {\r\n      if (from[prop]) {\r\n        destination[prop] = from[prop];\r\n      }\r\n    }\r\n    return destination;\r\n  }\r\n\r\n  function inherits(child, uber) {\r\n    child.prototype = extend(child.prototype || {}, uber.prototype);\r\n  }\r\n\r\n  function hasIgnoredElements(el) {\r\n    while (el.parentNode) {\r\n      if (el.getAttribute('data-slideout-ignore') !== null) {\r\n        return el;\r\n      }\r\n      el = el.parentNode;\r\n    }\r\n    return null;\r\n  }\r\n\r\n\r\n  /**\r\n   * Slideout constructor\r\n   */\r\n  function Slideout(options) {\r\n    options = options || {};\r\n\r\n    // Sets default values\r\n    this._startOffsetX = 0;\r\n    this._currentOffsetX = 0;\r\n    this._opening = false;\r\n    this._moved = false;\r\n    this._opened = false;\r\n    this._preventOpen = false;\r\n    this._touch = options.touch === undefined ? true : options.touch && true;\r\n    this._side = options.side || 'left';\r\n\r\n    // Sets panel\r\n    this.panel = options.panel;\r\n    this.menu = options.menu;\r\n\r\n    // Sets  classnames\r\n    if (!this.panel.classList.contains('slideout-panel')) {\r\n      this.panel.classList.add('slideout-panel');\r\n    }\r\n    if (!this.panel.classList.contains('slideout-panel-' + this._side)) {\r\n      this.panel.classList.add('slideout-panel-' + this._side);\r\n    }\r\n    if (!this.menu.classList.contains('slideout-menu')) {\r\n      this.menu.classList.add('slideout-menu');\r\n    }\r\n    if (!this.menu.classList.contains('slideout-menu-' + this._side)) {\r\n      this.menu.classList.add('slideout-menu-' + this._side);\r\n    }\r\n\r\n    // Sets options\r\n    this._fx = options.fx || 'ease';\r\n    this._duration = parseInt(options.duration, 10) || 300;\r\n    this._tolerance = parseInt(options.tolerance, 10) || 70;\r\n    this._padding = this._translateTo = parseInt(options.padding, 10) || 256;\r\n    this._orientation = this._side === 'right' ? -1 : 1;\r\n    this._translateTo *= this._orientation;\r\n\r\n    // Init touch events\r\n    if (this._touch) {\r\n      this._initTouchEvents();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Inherits from Emitter\r\n   */\r\n  inherits(Slideout, Emitter);\r\n\r\n  /**\r\n   * Opens the slideout menu.\r\n   */\r\n  Slideout.prototype.open = function() {\r\n    var self = this;\r\n    this.emit('beforeopen');\r\n    if (!html.classList.contains('slideout-open')) {\r\n      html.classList.add('slideout-open');\r\n    }\r\n    this._setTransition();\r\n    this._translateXTo(this._translateTo);\r\n    this._opened = true;\r\n    setTimeout(function() {\r\n      self.panel.style.transition = self.panel.style['-webkit-transition'] = '';\r\n      self.emit('open');\r\n    }, this._duration + 50);\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * Closes slideout menu.\r\n   */\r\n  Slideout.prototype.close = function() {\r\n    var self = this;\r\n    if (!this.isOpen() && !this._opening) {\r\n      return this;\r\n    }\r\n    this.emit('beforeclose');\r\n    this._setTransition();\r\n    this._translateXTo(0);\r\n    this._opened = false;\r\n    setTimeout(function() {\r\n      html.classList.remove('slideout-open');\r\n      self.panel.style.transition = self.panel.style['-webkit-transition'] = self.panel.style[prefix + 'transform'] = self.panel.style.transform = '';\r\n      self.emit('close');\r\n    }, this._duration + 50);\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * Toggles (open/close) slideout menu.\r\n   */\r\n  Slideout.prototype.toggle = function() {\r\n    return this.isOpen() ? this.close() : this.open();\r\n  };\r\n\r\n  /**\r\n   * Returns true if the slideout is currently open, and false if it is closed.\r\n   */\r\n  Slideout.prototype.isOpen = function() {\r\n    return this._opened;\r\n  };\r\n\r\n  /**\r\n   * Translates panel and updates currentOffset with a given X point\r\n   */\r\n  Slideout.prototype._translateXTo = function(translateX) {\r\n    this._currentOffsetX = translateX;\r\n    this.panel.style[prefix + 'transform'] = this.panel.style.transform = 'translateX(' + translateX + 'px)';\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * Set transition properties\r\n   */\r\n  Slideout.prototype._setTransition = function() {\r\n    this.panel.style[prefix + 'transition'] = this.panel.style.transition = prefix + 'transform ' + this._duration + 'ms ' + this._fx;\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * Initializes touch event\r\n   */\r\n  Slideout.prototype._initTouchEvents = function() {\r\n    var self = this;\r\n\r\n    /**\r\n     * Decouple scroll event\r\n     */\r\n    this._onScrollFn = decouple(doc, 'scroll', function() {\r\n      if (!self._moved) {\r\n        clearTimeout(scrollTimeout);\r\n        scrolling = true;\r\n        scrollTimeout = setTimeout(function() {\r\n          scrolling = false;\r\n        }, 250);\r\n      }\r\n    });\r\n\r\n    /**\r\n     * Prevents touchmove event if slideout is moving\r\n     */\r\n    this._preventMove = function(eve) {\r\n      if (self._moved) {\r\n        eve.preventDefault();\r\n      }\r\n    };\r\n\r\n    doc.addEventListener(touch.move, this._preventMove);\r\n\r\n    /**\r\n     * Resets values on touchstart\r\n     */\r\n    this._resetTouchFn = function(eve) {\r\n      if (typeof eve.touches === 'undefined') {\r\n        return;\r\n      }\r\n\r\n      self._moved = false;\r\n      self._opening = false;\r\n      self._startOffsetX = eve.touches[0].pageX;\r\n      self._preventOpen = (!self._touch || (!self.isOpen() && self.menu.clientWidth !== 0));\r\n    };\r\n\r\n    this.panel.addEventListener(touch.start, this._resetTouchFn);\r\n\r\n    /**\r\n     * Resets values on touchcancel\r\n     */\r\n    this._onTouchCancelFn = function() {\r\n      self._moved = false;\r\n      self._opening = false;\r\n    };\r\n\r\n    this.panel.addEventListener('touchcancel', this._onTouchCancelFn);\r\n\r\n    /**\r\n     * Toggles slideout on touchend\r\n     */\r\n    this._onTouchEndFn = function() {\r\n      if (self._moved) {\r\n        self.emit('translateend');\r\n        (self._opening && Math.abs(self._currentOffsetX) > self._tolerance) ? self.open() : self.close();\r\n      }\r\n      self._moved = false;\r\n    };\r\n\r\n    this.panel.addEventListener(touch.end, this._onTouchEndFn);\r\n\r\n    /**\r\n     * Translates panel on touchmove\r\n     */\r\n    this._onTouchMoveFn = function(eve) {\r\n      if (\r\n        scrolling ||\r\n        self._preventOpen ||\r\n        typeof eve.touches === 'undefined' ||\r\n        hasIgnoredElements(eve.target)\r\n      ) {\r\n        return;\r\n      }\r\n\r\n      var dif_x = eve.touches[0].clientX - self._startOffsetX;\r\n      var translateX = self._currentOffsetX = dif_x;\r\n\r\n      if (Math.abs(translateX) > self._padding) {\r\n        return;\r\n      }\r\n\r\n      if (Math.abs(dif_x) > 20) {\r\n\r\n        self._opening = true;\r\n\r\n        var oriented_dif_x = dif_x * self._orientation;\r\n\r\n        if (self._opened && oriented_dif_x > 0 || !self._opened && oriented_dif_x < 0) {\r\n          return;\r\n        }\r\n\r\n        if (!self._moved) {\r\n          self.emit('translatestart');\r\n        }\r\n\r\n        if (oriented_dif_x <= 0) {\r\n          translateX = dif_x + self._padding * self._orientation;\r\n          self._opening = false;\r\n        }\r\n\r\n        if (!(self._moved && html.classList.contains('slideout-open'))) {\r\n          html.classList.add('slideout-open');\r\n        }\r\n\r\n        self.panel.style[prefix + 'transform'] = self.panel.style.transform = 'translateX(' + translateX + 'px)';\r\n        self.emit('translate', translateX);\r\n        self._moved = true;\r\n      }\r\n\r\n    };\r\n\r\n    this.panel.addEventListener(touch.move, this._onTouchMoveFn);\r\n\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * Enable opening the slideout via touch events.\r\n   */\r\n  Slideout.prototype.enableTouch = function() {\r\n    this._touch = true;\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * Disable opening the slideout via touch events.\r\n   */\r\n  Slideout.prototype.disableTouch = function() {\r\n    this._touch = false;\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * Destroy an instance of slideout.\r\n   */\r\n  Slideout.prototype.destroy = function() {\r\n    // Close before clean\r\n    this.close();\r\n\r\n    // Remove event listeners\r\n    doc.removeEventListener(touch.move, this._preventMove);\r\n    this.panel.removeEventListener(touch.start, this._resetTouchFn);\r\n    this.panel.removeEventListener('touchcancel', this._onTouchCancelFn);\r\n    this.panel.removeEventListener(touch.end, this._onTouchEndFn);\r\n    this.panel.removeEventListener(touch.move, this._onTouchMoveFn);\r\n    doc.removeEventListener('scroll', this._onScrollFn);\r\n\r\n    // Remove methods\r\n    this.open = this.close = function() {};\r\n\r\n    // Return the instance so it can be easily dereferenced\r\n    return this;\r\n  };\r\n\r\n  return Slideout;\r\n});\r\n\r\n"]}