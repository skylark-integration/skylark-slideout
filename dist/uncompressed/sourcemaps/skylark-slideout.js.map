{"version":3,"sources":["skylark-slideout.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"../skylark-slideout.js","sourcesContent":["define('skylark-slideout/decouple',[],function(){\r\n  'use strict';\r\n\r\n  var requestAnimFrame = (function() {\r\n    return window.requestAnimationFrame ||\r\n      window.webkitRequestAnimationFrame ||\r\n      function (callback) {\r\n        window.setTimeout(callback, 1000 / 60);\r\n      };\r\n  }());\r\n\r\n  function decouple(node, event, fn) {\r\n    var eve,\r\n        tracking = false;\r\n\r\n    function captureEvent(e) {\r\n      eve = e;\r\n      track();\r\n    }\r\n\r\n    function track() {\r\n      if (!tracking) {\r\n        requestAnimFrame(update);\r\n        tracking = true;\r\n      }\r\n    }\r\n\r\n    function update() {\r\n      fn.call(node, eve);\r\n      tracking = false;\r\n    }\r\n\r\n    node.addEventListener(event, captureEvent, false);\r\n\r\n    return captureEvent;\r\n  }\r\n\r\n  return decouple;\r\n});\ndefine('Emitter',[],function(){\r\n  /**\r\n   * Creates a new instance of Emitter.\r\n   * @class\r\n   * @returns {Object} Returns a new instance of Emitter.\r\n   * @example\r\n   * // Creates a new instance of Emitter.\r\n   * var Emitter = require('emitter');\r\n   *\r\n   * var emitter = new Emitter();\r\n   */\r\n\r\n  function Emitter() {\r\n  }\r\n\r\n  /**\r\n   * Adds a listener to the collection for the specified event.\r\n   * @memberof! Emitter.prototype\r\n   * @function\r\n   * @param {String} event - The event name.\r\n   * @param {Function} listener - A listener function to add.\r\n   * @returns {Object} Returns an instance of Emitter.\r\n   * @example\r\n   * // Add an event listener to \"foo\" event.\r\n   * emitter.on('foo', listener);\r\n   */\r\n\r\n  Emitter.prototype.on = function on(event, listener) {\r\n    // Use the current collection or create it.\r\n    this._eventCollection = this._eventCollection || {};\r\n\r\n    // Use the current collection of an event or create it.\r\n    this._eventCollection[event] = this._eventCollection[event] || [];\r\n\r\n    // Appends the listener into the collection of the given event\r\n    this._eventCollection[event].push(listener);\r\n\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * Adds a listener to the collection for the specified event that will be called only once.\r\n   * @memberof! Emitter.prototype\r\n   * @function\r\n   * @param {String} event - The event name.\r\n   * @param {Function} listener - A listener function to add.\r\n   * @returns {Object} Returns an instance of Emitter.\r\n   * @example\r\n   * // Will add an event handler to \"foo\" event once.\r\n   * emitter.once('foo', listener);\r\n   */\r\n\r\n  Emitter.prototype.once = function once(event, listener) {\r\n    var self = this;\r\n\r\n    function fn() {\r\n      self.off(event, fn);\r\n      listener.apply(this, arguments);\r\n    }\r\n\r\n    fn.listener = listener;\r\n\r\n    this.on(event, fn);\r\n\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * Removes a listener from the collection for the specified event.\r\n   * @memberof! Emitter.prototype\r\n   * @function\r\n   * @param {String} event - The event name.\r\n   * @param {Function} listener - A listener function to remove.\r\n   * @returns {Object} Returns an instance of Emitter.\r\n   * @example\r\n   * // Remove a given listener.\r\n   * emitter.off('foo', listener);\r\n   */\r\n\r\n  Emitter.prototype.off = function off(event, listener) {\r\n\r\n    var listeners = undefined;\r\n\r\n    // Defines listeners value.\r\n    if (!this._eventCollection || !(listeners = this._eventCollection[event])) {\r\n      return this;\r\n    }\r\n\r\n    listeners.forEach(function (fn, i) {\r\n      if (fn === listener || fn.listener === listener) {\r\n        // Removes the given listener.\r\n        listeners.splice(i, 1);\r\n      }\r\n    });\r\n\r\n    // Removes an empty event collection.\r\n    if (listeners.length === 0) {\r\n      delete this._eventCollection[event];\r\n    }\r\n\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * Execute each item in the listener collection in order with the specified data.\r\n   * @memberof! Emitter.prototype\r\n   * @function\r\n   * @param {String} event - The name of the event you want to emit.\r\n   * @param {...Object} data - Data to pass to the listeners.\r\n   * @returns {Object} Returns an instance of Emitter.\r\n   * @example\r\n   * // Emits the \"foo\" event with 'param1' and 'param2' as arguments.\r\n   * emitter.emit('foo', 'param1', 'param2');\r\n   */\r\n\r\n  Emitter.prototype.emit = function emit(event) {\r\n    var _this = this;\r\n\r\n    for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\r\n      args[_key - 1] = arguments[_key];\r\n    }\r\n\r\n    var listeners = undefined;\r\n\r\n    // Defines listeners value.\r\n    if (!this._eventCollection || !(listeners = this._eventCollection[event])) {\r\n      return this;\r\n    }\r\n\r\n    // Clone listeners\r\n    listeners = listeners.slice(0);\r\n\r\n    listeners.forEach(function (fn) {\r\n      return fn.apply(_this, args);\r\n    });\r\n\r\n    return this;\r\n  };\r\n\r\n  return Emitter;\r\n});\ndefine('skylark-slideout/Slideout',[\r\n  \"./decouple\",\r\n  \"Emitter\"\r\n],function(decouple,Emitter){\r\n  /**\r\n   * Privates\r\n   */\r\n  var scrollTimeout;\r\n  var scrolling = false;\r\n  var doc = window.document;\r\n  var html = doc.documentElement;\r\n  var msPointerSupported = window.navigator.msPointerEnabled;\r\n  \r\n  var touch = {\r\n    'start': msPointerSupported ? 'MSPointerDown' : 'touchstart',\r\n    'move': msPointerSupported ? 'MSPointerMove' : 'touchmove',\r\n    'end': msPointerSupported ? 'MSPointerUp' : 'touchend'\r\n  };\r\n\r\n  var prefix = (function prefix() {\r\n    var regex = /^(Webkit|Khtml|Moz|ms|O)(?=[A-Z])/;\r\n    var styleDeclaration = doc.getElementsByTagName('script')[0].style;\r\n    for (var prop in styleDeclaration) {\r\n      if (regex.test(prop)) {\r\n        return '-' + prop.match(regex)[0].toLowerCase() + '-';\r\n      }\r\n    }\r\n    // Nothing found so far? Webkit does not enumerate over the CSS properties of the style object.\r\n    // However (prop in style) returns the correct value, so we'll have to test for\r\n    // the precence of a specific property\r\n    if ('WebkitOpacity' in styleDeclaration) { return '-webkit-'; }\r\n    if ('KhtmlOpacity' in styleDeclaration) { return '-khtml-'; }\r\n    return '';\r\n  }());\r\n\r\n  function extend(destination, from) {\r\n    for (var prop in from) {\r\n      if (from[prop]) {\r\n        destination[prop] = from[prop];\r\n      }\r\n    }\r\n    return destination;\r\n  }\r\n\r\n  function inherits(child, uber) {\r\n    child.prototype = extend(child.prototype || {}, uber.prototype);\r\n  }\r\n\r\n  function hasIgnoredElements(el) {\r\n    while (el.parentNode) {\r\n      if (el.getAttribute('data-slideout-ignore') !== null) {\r\n        return el;\r\n      }\r\n      el = el.parentNode;\r\n    }\r\n    return null;\r\n  }\r\n\r\n\r\n  /**\r\n   * Slideout constructor\r\n   */\r\n  function Slideout(options) {\r\n    options = options || {};\r\n\r\n    // Sets default values\r\n    this._startOffsetX = 0;\r\n    this._currentOffsetX = 0;\r\n    this._opening = false;\r\n    this._moved = false;\r\n    this._opened = false;\r\n    this._preventOpen = false;\r\n    this._touch = options.touch === undefined ? true : options.touch && true;\r\n    this._side = options.side || 'left';\r\n\r\n    // Sets panel\r\n    this.panel = options.panel;\r\n    this.menu = options.menu;\r\n\r\n    // Sets  classnames\r\n    if (!this.panel.classList.contains('slideout-panel')) {\r\n      this.panel.classList.add('slideout-panel');\r\n    }\r\n    if (!this.panel.classList.contains('slideout-panel-' + this._side)) {\r\n      this.panel.classList.add('slideout-panel-' + this._side);\r\n    }\r\n    if (!this.menu.classList.contains('slideout-menu')) {\r\n      this.menu.classList.add('slideout-menu');\r\n    }\r\n    if (!this.menu.classList.contains('slideout-menu-' + this._side)) {\r\n      this.menu.classList.add('slideout-menu-' + this._side);\r\n    }\r\n\r\n    // Sets options\r\n    this._fx = options.fx || 'ease';\r\n    this._duration = parseInt(options.duration, 10) || 300;\r\n    this._tolerance = parseInt(options.tolerance, 10) || 70;\r\n    this._padding = this._translateTo = parseInt(options.padding, 10) || 256;\r\n    this._orientation = this._side === 'right' ? -1 : 1;\r\n    this._translateTo *= this._orientation;\r\n\r\n    // Init touch events\r\n    if (this._touch) {\r\n      this._initTouchEvents();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Inherits from Emitter\r\n   */\r\n  inherits(Slideout, Emitter);\r\n\r\n  /**\r\n   * Opens the slideout menu.\r\n   */\r\n  Slideout.prototype.open = function() {\r\n    var self = this;\r\n    this.emit('beforeopen');\r\n    if (!html.classList.contains('slideout-open')) {\r\n      html.classList.add('slideout-open');\r\n    }\r\n    this._setTransition();\r\n    this._translateXTo(this._translateTo);\r\n    this._opened = true;\r\n    setTimeout(function() {\r\n      self.panel.style.transition = self.panel.style['-webkit-transition'] = '';\r\n      self.emit('open');\r\n    }, this._duration + 50);\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * Closes slideout menu.\r\n   */\r\n  Slideout.prototype.close = function() {\r\n    var self = this;\r\n    if (!this.isOpen() && !this._opening) {\r\n      return this;\r\n    }\r\n    this.emit('beforeclose');\r\n    this._setTransition();\r\n    this._translateXTo(0);\r\n    this._opened = false;\r\n    setTimeout(function() {\r\n      html.classList.remove('slideout-open');\r\n      self.panel.style.transition = self.panel.style['-webkit-transition'] = self.panel.style[prefix + 'transform'] = self.panel.style.transform = '';\r\n      self.emit('close');\r\n    }, this._duration + 50);\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * Toggles (open/close) slideout menu.\r\n   */\r\n  Slideout.prototype.toggle = function() {\r\n    return this.isOpen() ? this.close() : this.open();\r\n  };\r\n\r\n  /**\r\n   * Returns true if the slideout is currently open, and false if it is closed.\r\n   */\r\n  Slideout.prototype.isOpen = function() {\r\n    return this._opened;\r\n  };\r\n\r\n  /**\r\n   * Translates panel and updates currentOffset with a given X point\r\n   */\r\n  Slideout.prototype._translateXTo = function(translateX) {\r\n    this._currentOffsetX = translateX;\r\n    this.panel.style[prefix + 'transform'] = this.panel.style.transform = 'translateX(' + translateX + 'px)';\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * Set transition properties\r\n   */\r\n  Slideout.prototype._setTransition = function() {\r\n    this.panel.style[prefix + 'transition'] = this.panel.style.transition = prefix + 'transform ' + this._duration + 'ms ' + this._fx;\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * Initializes touch event\r\n   */\r\n  Slideout.prototype._initTouchEvents = function() {\r\n    var self = this;\r\n\r\n    /**\r\n     * Decouple scroll event\r\n     */\r\n    this._onScrollFn = decouple(doc, 'scroll', function() {\r\n      if (!self._moved) {\r\n        clearTimeout(scrollTimeout);\r\n        scrolling = true;\r\n        scrollTimeout = setTimeout(function() {\r\n          scrolling = false;\r\n        }, 250);\r\n      }\r\n    });\r\n\r\n    /**\r\n     * Prevents touchmove event if slideout is moving\r\n     */\r\n    this._preventMove = function(eve) {\r\n      if (self._moved) {\r\n        eve.preventDefault();\r\n      }\r\n    };\r\n\r\n    doc.addEventListener(touch.move, this._preventMove);\r\n\r\n    /**\r\n     * Resets values on touchstart\r\n     */\r\n    this._resetTouchFn = function(eve) {\r\n      if (typeof eve.touches === 'undefined') {\r\n        return;\r\n      }\r\n\r\n      self._moved = false;\r\n      self._opening = false;\r\n      self._startOffsetX = eve.touches[0].pageX;\r\n      self._preventOpen = (!self._touch || (!self.isOpen() && self.menu.clientWidth !== 0));\r\n    };\r\n\r\n    this.panel.addEventListener(touch.start, this._resetTouchFn);\r\n\r\n    /**\r\n     * Resets values on touchcancel\r\n     */\r\n    this._onTouchCancelFn = function() {\r\n      self._moved = false;\r\n      self._opening = false;\r\n    };\r\n\r\n    this.panel.addEventListener('touchcancel', this._onTouchCancelFn);\r\n\r\n    /**\r\n     * Toggles slideout on touchend\r\n     */\r\n    this._onTouchEndFn = function() {\r\n      if (self._moved) {\r\n        self.emit('translateend');\r\n        (self._opening && Math.abs(self._currentOffsetX) > self._tolerance) ? self.open() : self.close();\r\n      }\r\n      self._moved = false;\r\n    };\r\n\r\n    this.panel.addEventListener(touch.end, this._onTouchEndFn);\r\n\r\n    /**\r\n     * Translates panel on touchmove\r\n     */\r\n    this._onTouchMoveFn = function(eve) {\r\n      if (\r\n        scrolling ||\r\n        self._preventOpen ||\r\n        typeof eve.touches === 'undefined' ||\r\n        hasIgnoredElements(eve.target)\r\n      ) {\r\n        return;\r\n      }\r\n\r\n      var dif_x = eve.touches[0].clientX - self._startOffsetX;\r\n      var translateX = self._currentOffsetX = dif_x;\r\n\r\n      if (Math.abs(translateX) > self._padding) {\r\n        return;\r\n      }\r\n\r\n      if (Math.abs(dif_x) > 20) {\r\n\r\n        self._opening = true;\r\n\r\n        var oriented_dif_x = dif_x * self._orientation;\r\n\r\n        if (self._opened && oriented_dif_x > 0 || !self._opened && oriented_dif_x < 0) {\r\n          return;\r\n        }\r\n\r\n        if (!self._moved) {\r\n          self.emit('translatestart');\r\n        }\r\n\r\n        if (oriented_dif_x <= 0) {\r\n          translateX = dif_x + self._padding * self._orientation;\r\n          self._opening = false;\r\n        }\r\n\r\n        if (!(self._moved && html.classList.contains('slideout-open'))) {\r\n          html.classList.add('slideout-open');\r\n        }\r\n\r\n        self.panel.style[prefix + 'transform'] = self.panel.style.transform = 'translateX(' + translateX + 'px)';\r\n        self.emit('translate', translateX);\r\n        self._moved = true;\r\n      }\r\n\r\n    };\r\n\r\n    this.panel.addEventListener(touch.move, this._onTouchMoveFn);\r\n\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * Enable opening the slideout via touch events.\r\n   */\r\n  Slideout.prototype.enableTouch = function() {\r\n    this._touch = true;\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * Disable opening the slideout via touch events.\r\n   */\r\n  Slideout.prototype.disableTouch = function() {\r\n    this._touch = false;\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * Destroy an instance of slideout.\r\n   */\r\n  Slideout.prototype.destroy = function() {\r\n    // Close before clean\r\n    this.close();\r\n\r\n    // Remove event listeners\r\n    doc.removeEventListener(touch.move, this._preventMove);\r\n    this.panel.removeEventListener(touch.start, this._resetTouchFn);\r\n    this.panel.removeEventListener('touchcancel', this._onTouchCancelFn);\r\n    this.panel.removeEventListener(touch.end, this._onTouchEndFn);\r\n    this.panel.removeEventListener(touch.move, this._onTouchMoveFn);\r\n    doc.removeEventListener('scroll', this._onScrollFn);\r\n\r\n    // Remove methods\r\n    this.open = this.close = function() {};\r\n\r\n    // Return the instance so it can be easily dereferenced\r\n    return this;\r\n  };\r\n\r\n  return Slideout;\r\n});\r\n\r\n\ndefine('skylark-slideout/main',[\r\n\t\"./Slideout\"\r\n],function(Slideout){\r\n\treturn Slideout;\r\n});\ndefine('skylark-slideout', ['skylark-slideout/main'], function (main) { return main; });\n\n"]}